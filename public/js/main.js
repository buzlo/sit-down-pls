function addBurgerListeners(){const e=document.querySelector(".burger"),t=document.querySelector(".header__nav .nav__list"),r=t.querySelectorAll(".nav__link");e.addEventListener("click",(function(){e.classList.toggle("burger_active"),t.classList.toggle("nav__list_active"),document.body.classList.toggle("stop-scroll")})),r.forEach((function(r){r.addEventListener("click",(function(){e.classList.remove("burger_active"),t.classList.remove("nav__list_active"),document.body.classList.remove("stop-scroll")}))}))}function addSearchCategoriesToSelect(e){getSearchCategories().forEach((t=>{const r=document.createElement("option");r.classList.add("search__option"),r.textContent=t.title,r.value=t.id,e.append(r)}))}function createValidator(e,t){const r=new JustValidate(e,{validateBeforeSubmitting:!0,errorFieldCssClass:"invalid",errorLabelCssClass:"input-wrapper__error-label",errorLabelStyle:{},successFieldCssClass:"valid"});for(const i of t){const t=[{rule:"required",errorMessage:"Обязательное поле"}];"tel"===i?t.push({rule:"number",errorMessage:"Недопустимый формат",rule:"minLength",value:11,errorMessage:"Номер должен быть не короче 11 цифр"}):"email"===i&&t.push({rule:"email",errorMessage:"Недопустимый формат"}),r.addField(`${e} [name = ${i}]`,t)}return r}function createArticlesList(e){const t=["320","768","1024"],r=document.createElement("ul");return r.classList.add("articles__list"),r.classList.add("swiper-wrapper"),e.forEach((e=>{const i=document.createElement("li"),c=document.createElement("picture"),a=document.createElement("img"),s=document.createElement("h2"),n=document.createElement("button");i.classList.add("articles__item","article-card","card","swiper-slide");for(const r of t){const t=document.createElement("source");t.media=`(max-width: ${r}px)`,t.srcset=`img/article-${e.id}-${r}.png`,c.append(t)}a.classList.add("article-card__img"),a.src=`img/article-${e.id}.png`,c.classList.add("article-card__picture"),c.append(a),s.classList.add("article-card__title"),s.textContent=e.title,n.classList.add("article-card__btn","btn","btn_secondary"),n.textContent="Читать",i.append(c,s,n),r.append(i)})),r}function createBtn(e,t,r,i){const c=document.createElement("button");return c.classList.add(`${e}__btn`,"btn",`btn_${t}`),c.textContent=r,c.addEventListener("click",(()=>i())),c}function createCategoriesList(e){const t=["320","768","1024"],r=document.createElement("ul");return r.classList.add("categories__list"),e.forEach((e=>{const i=document.createElement("li"),c=document.createElement("ul"),a=document.createElement("h2"),s=document.createElement("picture"),n=document.createElement("img"),o=document.createElement("a"),l=document.createElement("span"),d=createSvg(["../img/svg/sprite.svg#arrow-right"]);i.classList.add("categories__item","category-card","card"),c.classList.add("category-card__subcategories-list");for(const t of e.subCategories){const e=document.createElement("li"),r=document.createElement("a");e.classList.add("category-card__subcategories-item"),r.classList.add("category-card__subcategories-link"),r.href="#",r.textContent=t.title,e.append(r),c.append(e)}a.classList.add("category-card__title"),a.textContent=e.title;for(const r of t){const t=document.createElement("source");t.media=`(max-width: ${r}px)`,t.srcset=`img/category-${e.id}-${r}.png`,s.append(t)}n.classList.add("category-card__img"),n.src=`img/category-${e.id}.png`,s.classList.add("category-card__picture"),s.append(n),o.href="#",d.setAttribute("width","22"),d.setAttribute("height","22"),o.append(d);const u=o.cloneNode(!0);o.classList.add("category-card__btn","btn","btn_arrow"),l.textContent="В каталог",o.prepend(l),u.classList.add("category-card__title-btn","btn","btn_arrow"),a.append(u),i.append(c,a,s,o),r.append(i)})),r}function createChoicesFromSelect(e,t,{svgUrl:r,svgWidth:i,svgHeight:c}={}){const a=new Choices(e,{searchEnabled:!1,itemSelectText:"",shouldSort:!1}),s=a.containerOuter.element;if(t&&s.classList.add(`${t}__choices`),r){const e=createSvg([r]);e.classList.add("choices__svg"),e.setAttribute("width",i),e.setAttribute("height",c),s.append(e)}return a}function createProductsList(e,t,r){const i=["320","768","1024"],c=document.createElement("ul"),a="specials"===t;return c.classList.add(`${t}__list`),r&&c.classList.add("swiper-wrapper"),e.forEach((e=>{const s=document.createElement("li"),n=document.createElement("picture"),o=document.createElement("img"),l=document.createElement("h2"),d=document.createElement("span"),u=document.createElement("a");s.classList.add(`${t}__item`,"product-card","card"),n.classList.add("product-card__picture");for(const t of i){const r=document.createElement("source");r.media=`(max-width: ${t}px)`,r.srcset=`img/product-${e.id}-${t}.png`,n.append(r)}if(o.classList.add("product-card__img"),o.src=`img/product-${e.id}.png`,o.alt="Изображение товара",n.append(o),l.classList.add("product-card__title"),l.textContent=e.title,s.append(n,l),d.classList.add("product-card__price"),d.textContent=`${numberFormat(e.price)} руб`,a){const t=document.createElement("span"),r=document.createElement("span"),i=document.createElement("p");if(s.classList.add("product-card_special"),t.classList.add("product-card__old-price"),t.textContent=`${numberFormat(e.oldPrice)} руб`,r.classList.add("product-card__price-wrapper"),i.classList.add("product-card__discount"),i.textContent=`- ${numberFormat(e.discount)}`,e.major){const t=document.createElement("img");t.classList.add("product-card__scheme"),t.src=`img/product-${e.id}-scheme.png`,t.alt="Схема разборки",s.append(t)}r.append(d,t),s.append(r,i)}else{const t=document.createElement("p");t.classList.add("product-card__rating","rating"),t.textContent=e.rating,s.append(d,t)}r&&s.classList.add("swiper-slide","product-card_swiper"),u.href="/details.html",u.classList.add("product-card__btn","btn","btn_secondary"),u.textContent="Купить",s.append(u),c.append(s)})),c}function numberFormat(e){return new Intl.NumberFormat(["ru"]).format(e)}function createSvg(e){const t="http://www.w3.org/2000/svg",r=document.createElementNS(t,"svg");for(let i of e)$use=document.createElementNS(t,"use"),$use.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i),r.append($use);return r}function getArticles(){const e=[{title:"И нет сомнений, что сделанные на базе интернет-аналитики выводы представляют собой не что иное?",url:"#"},{title:"Как принято считать, некоторые особенности приносят несомненную пользу обществу?",url:"#"},{title:"Ясность нашей позиции очевидна: укрепление и развитие внутренней структуры?",url:"#"},{title:"Прежде всего, консультация с широким активом однозначно фиксирует необходимость распределения?",url:"#"},{title:"Как принято считать, некоторые особенности приносят несомненную пользу обществу?",url:"#"}];return e.forEach(((e,t)=>{e.id=t+1})),e}function getCategories(){const e=[{title:"Диваны",url:"#",subCategories:[{title:"Прямые",url:"#"},{title:"Угловые",url:"#"},{title:"Модульные",url:"#"}]},{title:"Кресла",url:"#",subCategories:[{title:"Мягкие",url:"#"},{title:"Кресла-кровати",url:"#"}]},{title:"Кровати",url:"#",subCategories:[{title:"Односпальные",url:"#"},{title:"Двуспальные",url:"#"}]},{title:"Тумбы и комоды",url:"#",subCategories:[{title:"Тумбы",url:"#"},{title:"Комоды",url:"#"}]},{title:"Стулья",url:"#",subCategories:[{title:"Деревянные",url:"#"},{title:"Металлокаркас",url:"#"}]}];return e.forEach(((e,t)=>{e.id=t+1})),e}function getProducts(e){const t=[{title:"Кресло велюровое “X‑24”",price:15990,oldPrice:24990},{title:"Диван тканевый “Z‑44”",price:22990,oldPrice:32990,major:!0},{title:"Будильник  “Quartz‑23”",price:1290,oldPrice:1890},{title:"Мини‑скульптура “Oh my deer”",price:690,oldPrice:990},{title:"Диван вел‑флок “Z‑85”",price:22990,oldPrice:32990,major:!0},{title:"Термометр + гидрометр “H‑18”",price:1390,oldPrice:2090},{title:"Диван кожаный “R‑94”",price:94990,rating:"5,0"},{title:"Диван апартековый “T‑75”",price:69900,rating:"4,9"},{title:"Диван тканевый “D‑31”",price:28490,rating:"4,8"},{title:"Диван велюровый “Y‑68”",price:22990,rating:"4,8"},{title:"Диван из шинила “W‑95”",price:22990,rating:"4,8"},{title:"Диван флоковый “G‑41”",price:17990,rating:"4,8"},{title:"Диван шиниловый “V‑43”",price:19990,rating:"4,8"},{title:"Диван велюровый “S‑99”",price:19990,rating:"4,7"},{title:"Диван из кожзама “F‑85”",price:269990,rating:"4,7"},{title:"Диван флоковый “H‑64”",price:25990,rating:"4,6"},{title:"Диван флоковый “H‑58”",price:23990,rating:"4,6"},{title:"Диван из кожзама “R‑43”",price:33990,rating:"4,6"},{title:"Диван из шинила “С‑42”",price:18990,rating:"4,6"},{title:"Диван велюровый “U‑58”",price:21990,rating:"4,6"},{title:"Диван флоковый “F‑41”",price:4.5,rating:"4,5"},{title:"Диван велюровый “R‑85”",price:34990,rating:"4,5"},{title:"Диван велюровый “S‑44”",price:19990,rating:"4,5"},{title:"Диван из шинила “С‑80”",price:20990,rating:"4,4"}];return t.forEach(((e,t)=>{e.id=t+1,e.oldPrice&&(e.discount=e.oldPrice-e.price)})),e?t.filter((t=>e.includes(t.id))):t}function getSearchCategories(){const e=[{title:"Диваны"},{title:"Комоды"},{title:"Кресла"},{title:"Стулья"},{title:"Пуфы"},{title:"Столы"},{title:"Кровати"},{title:"Аксессуары"},{title:"Тумбы"}];return e.forEach(((e,t)=>{e.id=t+1})),e}function initDetailsPage(){const e=createProductsList(getProducts([22,17,23,13]),"similar-products",!0);document.querySelector(".similar-products__swiper").append(e),initSwipers("details")}function initMainPage(){const e=getProducts(),t=[],r=e.filter((e=>(e.discount||t.push(e),e.discount))),i=getCategories(),c=getArticles(),a=createProductsList(r,"specials",!0),s=document.querySelector(".specials__swiper"),n=document.querySelector(".top-products"),o=createProductsList(t,"top-products"),l=o.childNodes;let d;d=matchMedia("(max-width: 1919px)").matches?6:8;const u=d/2;$topProductsBtn=createBtn("top-products","primary","Смотреть больше товаров",(()=>{for(let e=0;e<u;e++){if(d===l.length){$topProductsBtn.classList.add("d-none");break}l[d].classList.remove("d-none"),d+=1}})),n.append(o,$topProductsBtn);for(let e=d;e<l.length;e++)l[e].classList.add("d-none");$topCategoriesSection=document.querySelector(".categories"),$topCategoriesList=createCategoriesList(i),$articlesSwiper=document.querySelector(".articles__swiper"),$articlesList=createArticlesList(c),s.append(a),$topCategoriesSection.append($topCategoriesList),$articlesSwiper.append($articlesList),initSwipers("main"),createValidator(".application__form",["name","tel","email"])}function initSwipers(e){if("main"===e){new Swiper(".hero__swiper",{pagination:{el:".hero__pagination",type:"bullets",clickable:!0},autoplay:{delay:3e3},a11y:{paginationBulletMessage:"Перейти к слайду {{index}}"}}),new Swiper(".specials__swiper",{navigation:{nextEl:".specials__next",prevEl:".specials__prev"},slidesPerView:"auto",spaceBetween:32}),new Swiper(".articles__swiper",{navigation:{nextEl:".articles__next",prevEl:".articles__prev"},slidesPerView:1,spaceBetween:32,breakpoints:{1920:{slidesPerView:2},1024:{slidesPerView:3},768:{slidesPerView:2}}})}if("details"===e){new Swiper(".similar-products__swiper",{navigation:{nextEl:".similar-products__next",prevEl:".similar-products__prev"},slidesPerView:"auto",spaceBetween:32,breakpoints:{320:{spaceBetween:16}}})}}const choicesIconParams={svgUrl:"./img/svg/sprite.svg#arrow-down",svgWidth:"11",svgHeight:"11"},$regionSelect=document.querySelector(".region__select");createChoicesFromSelect($regionSelect,"region",choicesIconParams);const $searchSelect=document.querySelector(".search__select");addSearchCategoriesToSelect($searchSelect),createChoicesFromSelect($searchSelect,"search",choicesIconParams),addBurgerListeners();
